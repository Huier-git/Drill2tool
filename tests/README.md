# AutoTask 测试套件

本目录包含AutoTask模块的所有测试代码，与正式代码完全隔离。

## 目录结构

```
tests/
├── README.md           # 本文件
├── unit/               # 单元测试
│   └── test_autotask.cpp
└── mock/               # 模拟数据生成器
    ├── MockDataGenerator.h
    └── MockDataGenerator.cpp
```

## 如何启用/禁用测试功能

### 方法1：修改 DrillControl.pro（推荐）

在 `DrillControl.pro` 文件顶部找到：

```qmake
# ==================================================
# 测试模式开关
# ==================================================
# CONFIG += test_mode
```

- **启用测试**：取消注释 `CONFIG += test_mode`
- **禁用测试**：注释掉此行（默认状态）

### 方法2：qmake命令行

```bash
# 启用测试模式编译
qmake CONFIG+=test_mode

# 正常编译（禁用测试）
qmake
```

## 测试功能说明

启用测试模式后，会自动包含以下功能：

### 1. UI中的测试面板（AutoTaskPage）
- "测试场景"按钮组
  - 正常钻进
  - 扭矩超限
  - 钻压超限
  - 堵转
  - 逐步恶化
- "运行单元测试"按钮

### 2. 单元测试套件
- 钻压计算公式验证
- 扭矩限位触发测试
- 钻压限位触发测试
- 堵转检测测试
- 数据块解析测试
- 预设加载测试

### 3. 模拟数据生成器
- 5种钻进场景模拟
- 10Hz数据生成频率
- 完全兼容真实传感器数据格式

## 注意事项

⚠️ **发布版本必须禁用测试模式**
- 测试代码会增加约100KB的二进制体积
- UI中会显示测试按钮（影响用户体验）

✅ **开发调试时启用测试模式**
- 无需连接真实硬件即可验证功能
- 快速验证安全限位逻辑
- 回归测试防止代码改动引入Bug
